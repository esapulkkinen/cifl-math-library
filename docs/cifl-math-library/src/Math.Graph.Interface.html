<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span> </span><span class="hs-pragma">{-# LANGUAGE Safe, MultiParamTypeClasses, FunctionalDependencies #-}</span><span>
</span><a name="line-2"></a><span> </span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><a name="line-3"></a><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math.Graph.Interface</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span>
</span><a name="line-5"></a><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-6"></a><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-8"></a><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span> </span><span class="hs-keyword">import</span><span> </span><a href="Math.Tools.Set.html"><span class="hs-identifier">Math.Tools.Set</span></a><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span> </span><span class="hs-keyword">class</span><span> </span><a name="DigraphFactory"><a href="Math.Graph.Interface.html#DigraphFactory"><span class="hs-identifier">DigraphFactory</span></a></a><span> </span><a name="local-6989586621679194656"><a href="#local-6989586621679194656"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679194657"><a href="#local-6989586621679194657"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679194658"><a href="#local-6989586621679194658"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-12"></a><span>    </span><a name="vertexGraph"><a href="Math.Graph.Interface.html#vertexGraph"><span class="hs-identifier">vertexGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194656"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-13"></a><span>    </span><a name="edgeGraph"><a href="Math.Graph.Interface.html#edgeGraph"><span class="hs-identifier">edgeGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194658"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194656"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-14"></a><span>    </span><a name="verticesFromSetGraph"><a href="Math.Graph.Interface.html#verticesFromSetGraph"><span class="hs-identifier">verticesFromSetGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194656"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-15"></a><span>    </span><a name="verticesGraph"><a href="Math.Graph.Interface.html#verticesGraph"><span class="hs-identifier">verticesGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194656"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-16"></a><span>    </span><a name="completeGraph"><a href="Math.Graph.Interface.html#completeGraph"><span class="hs-identifier">completeGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194658"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194656"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-17"></a><span>    </span><a name="edgeGraphFromMap"><a href="Math.Graph.Interface.html#edgeGraphFromMap"><span class="hs-identifier">edgeGraphFromMap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679194658"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194656"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-18"></a><span>    </span><a name="edgesGraph"><a href="Math.Graph.Interface.html#edgesGraph"><span class="hs-identifier">edgesGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679194658"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194656"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-19"></a><span>    </span><a name="loopGraph"><a href="Math.Graph.Interface.html#loopGraph"><span class="hs-identifier">loopGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679194657"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><a href="#local-6989586621679194658"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194656"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span> </span><span class="hs-keyword">class</span><span> </span><a name="ReversibleGraphFactory"><a href="Math.Graph.Interface.html#ReversibleGraphFactory"><span class="hs-identifier">ReversibleGraphFactory</span></a></a><span> </span><a name="local-6989586621679194653"><a href="#local-6989586621679194653"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679194654"><a href="#local-6989586621679194654"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679194655"><a href="#local-6989586621679194655"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span>    </span><a name="reversibleVertexGraph"><a href="Math.Graph.Interface.html#reversibleVertexGraph"><span class="hs-identifier">reversibleVertexGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194653"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-23"></a><span>    </span><a name="reversibleVerticesGraph"><a href="Math.Graph.Interface.html#reversibleVerticesGraph"><span class="hs-identifier">reversibleVerticesGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194653"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-24"></a><span>    </span><a name="reversibleVerticesFromSetGraph"><a href="Math.Graph.Interface.html#reversibleVerticesFromSetGraph"><span class="hs-identifier">reversibleVerticesFromSetGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194653"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-25"></a><span>    </span><a name="reversibleEdgeGraph"><a href="Math.Graph.Interface.html#reversibleEdgeGraph"><span class="hs-identifier">reversibleEdgeGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194655"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194655"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194653"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-26"></a><span>    </span><a name="reversibleCompleteGraph"><a href="Math.Graph.Interface.html#reversibleCompleteGraph"><span class="hs-identifier">reversibleCompleteGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194655"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194655"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194653"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-27"></a><span>    </span><a name="reversibleEdgesGraph"><a href="Math.Graph.Interface.html#reversibleEdgesGraph"><span class="hs-identifier">reversibleEdgesGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679194655"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194655"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194653"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-28"></a><span>    </span><a name="reversibleLoopGraph"><a href="Math.Graph.Interface.html#reversibleLoopGraph"><span class="hs-identifier">reversibleLoopGraph</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679194654"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><a href="#local-6989586621679194655"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194655"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194653"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span> </span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="Math.Graph.Interface.html#GraphMonad"><span class="hs-identifier hs-type">GraphMonad</span></a><span> </span><a href="#local-6989586621679194650"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194652"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="LabeledGraphMonad"><a href="Math.Graph.Interface.html#LabeledGraphMonad"><span class="hs-identifier">LabeledGraphMonad</span></a></a><span> </span><a name="local-6989586621679194650"><a href="#local-6989586621679194650"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679194651"><a href="#local-6989586621679194651"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621679194652"><a href="#local-6989586621679194652"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-31"></a><span>    </span><a name="glabelOf"><a href="Math.Graph.Interface.html#glabelOf"><span class="hs-identifier">glabelOf</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194652"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194650"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194651"><span class="hs-identifier hs-type">lbl</span></a><span>
</span><a name="line-32"></a><span>    </span><a name="gfind"><a href="Math.Graph.Interface.html#gfind"><span class="hs-identifier">gfind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194651"><span class="hs-identifier hs-type">lbl</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194650"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194652"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span> </span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Arrow</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="GraphArrow"><a href="Math.Graph.Interface.html#GraphArrow"><span class="hs-identifier">GraphArrow</span></a></a><span> </span><a name="local-6989586621679194648"><a href="#local-6989586621679194648"><span class="hs-identifier">arr</span></a></a><span> </span><a name="local-6989586621679194649"><a href="#local-6989586621679194649"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-35"></a><span>   </span><a name="gisVertexA"><a href="Math.Graph.Interface.html#gisVertexA"><span class="hs-identifier">gisVertexA</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-36"></a><span>   </span><a name="gsourceA"><a href="Math.Graph.Interface.html#gsourceA"><span class="hs-identifier">gsourceA</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-37"></a><span>   </span><a name="gtargetA"><a href="Math.Graph.Interface.html#gtargetA"><span class="hs-identifier">gtargetA</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-38"></a><span>   </span><a name="gelementsA"><a href="Math.Graph.Interface.html#gelementsA"><span class="hs-identifier">gelementsA</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>   </span><a name="gverticesA"><a href="Math.Graph.Interface.html#gverticesA"><span class="hs-identifier">gverticesA</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>   </span><a name="gedgesA"><a href="Math.Graph.Interface.html#gedgesA"><span class="hs-identifier">gedgesA</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>   </span><a name="gedgesStartingFromA"><a href="Math.Graph.Interface.html#gedgesStartingFromA"><span class="hs-identifier">gedgesStartingFromA</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>   </span><a name="gedgesEndingToA"><a href="Math.Graph.Interface.html#gedgesEndingToA"><span class="hs-identifier">gedgesEndingToA</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>   </span><a name="glinksA"><a href="Math.Graph.Interface.html#glinksA"><span class="hs-identifier">glinksA</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194648"><span class="hs-identifier hs-type">arr</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span> </span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="Math.Graph.Interface.html#GraphArrow"><span class="hs-identifier hs-type">GraphArrow</span></a><span> </span><a href="#local-6989586621679194646"><span class="hs-identifier hs-type">arr</span></a><span> </span><a href="#local-6989586621679194647"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="ReversibleGraphArrow"><a href="Math.Graph.Interface.html#ReversibleGraphArrow"><span class="hs-identifier">ReversibleGraphArrow</span></a></a><span> </span><a name="local-6989586621679194646"><a href="#local-6989586621679194646"><span class="hs-identifier">arr</span></a></a><span> </span><a name="local-6989586621679194647"><a href="#local-6989586621679194647"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-46"></a><span>   </span><a name="ginverseA"><a href="Math.Graph.Interface.html#ginverseA"><span class="hs-identifier">ginverseA</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194646"><span class="hs-identifier hs-type">arr</span></a><span> </span><a href="#local-6989586621679194647"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679194647"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-47"></a><span>   </span><a name="greversibleLinksA"><a href="Math.Graph.Interface.html#greversibleLinksA"><span class="hs-identifier">greversibleLinksA</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194646"><span class="hs-identifier hs-type">arr</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679194647"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194647"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679194647"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194647"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span> </span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="GraphMonad"><a href="Math.Graph.Interface.html#GraphMonad"><span class="hs-identifier">GraphMonad</span></a></a><span> </span><a name="local-6989586621679194639"><a href="#local-6989586621679194639"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679194640"><a href="#local-6989586621679194640"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-50"></a><span>   </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">gsource</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">gtarget</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">gelements</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">gvertices</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">gedges</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">gedgesStartingFrom</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">gedgesEndingTo</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">glinks</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-51"></a><span>   </span><a name="gisVertex"><a href="Math.Graph.Interface.html#gisVertex"><span class="hs-identifier">gisVertex</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-52"></a><span>   </span><a name="gsource"><a href="Math.Graph.Interface.html#gsource"><span class="hs-identifier">gsource</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-53"></a><span>   </span><a name="gtarget"><a href="Math.Graph.Interface.html#gtarget"><span class="hs-identifier">gtarget</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-54"></a><span>   </span><a name="gelements"><a href="Math.Graph.Interface.html#gelements"><span class="hs-identifier">gelements</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>   </span><a name="gvertices"><a href="Math.Graph.Interface.html#gvertices"><span class="hs-identifier">gvertices</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>   </span><a name="gedges"><a href="Math.Graph.Interface.html#gedges"><span class="hs-identifier">gedges</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>   </span><a name="gedgesStartingFrom"><a href="Math.Graph.Interface.html#gedgesStartingFrom"><span class="hs-identifier">gedgesStartingFrom</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>   </span><a name="gedgesEndingTo"><a href="Math.Graph.Interface.html#gedgesEndingTo"><span class="hs-identifier">gedgesEndingTo</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>   </span><a name="glinks"><a href="Math.Graph.Interface.html#glinks"><span class="hs-identifier">glinks</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>   </span><a name="gloops"><a href="Math.Graph.Interface.html#gloops"><span class="hs-identifier">gloops</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>   </span><a name="gisLoop"><a href="Math.Graph.Interface.html#gisLoop"><span class="hs-identifier">gisLoop</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-62"></a><span>   </span><a name="local-8214565720323969508"><a href="Math.Graph.Interface.html#gisLoop"><span class="hs-identifier">gisLoop</span></a></a><span> </span><a name="local-6989586621679194641"><a href="#local-6989586621679194641"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Graph.Interface.html#gsource"><span class="hs-identifier hs-var">gsource</span></a><span> </span><a href="#local-6989586621679194641"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194642"><a href="#local-6989586621679194642"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Graph.Interface.html#gtarget"><span class="hs-identifier hs-var">gtarget</span></a><span> </span><a href="#local-6989586621679194641"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194643"><a href="#local-6989586621679194643"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194642"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194643"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>   </span><a name="local-8214565720323969498"><a href="Math.Graph.Interface.html#gisVertex"><span class="hs-identifier">gisVertex</span></a></a><span> </span><a name="local-6989586621679194644"><a href="#local-6989586621679194644"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Graph.Interface.html#gsource"><span class="hs-identifier hs-var">gsource</span></a><span> </span><a href="#local-6989586621679194644"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194645"><a href="#local-6989586621679194645"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194644"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194645"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>   </span><a name="gisEdgeBetween"><a href="Math.Graph.Interface.html#gisEdgeBetween"><span class="hs-identifier">gisEdgeBetween</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194640"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-65"></a><span>   </span><a name="local-8214565720323969509"><a href="Math.Graph.Interface.html#gisEdgeBetween"><span class="hs-identifier">gisEdgeBetween</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Graph.Interface.html#defaultGisEdgeBetween"><span class="hs-identifier hs-var">defaultGisEdgeBetween</span></a><span>
</span><a name="line-66"></a><span>   </span><a name="local-8214565720323969507"><a href="Math.Graph.Interface.html#gloops"><span class="hs-identifier">gloops</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Graph.Interface.html#defaultGloops"><span class="hs-identifier hs-var">defaultGloops</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span> </span><span class="hs-identifier">defaultGloops</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679194667"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Math.Graph.Interface.html#GraphMonad"><span class="hs-identifier hs-type">GraphMonad</span></a><span> </span><a href="#local-6989586621679194668"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194667"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679194668"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194667"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span> </span><a name="defaultGloops"><a href="Math.Graph.Interface.html#defaultGloops"><span class="hs-identifier">defaultGloops</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-70"></a><span>             </span><a name="local-6989586621679194672"><a href="#local-6989586621679194672"><span class="hs-identifier">edges</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#gedges"><span class="hs-identifier hs-var">gedges</span></a><span>
</span><a name="line-71"></a><span>             </span><a name="local-6989586621679194673"><a href="#local-6989586621679194673"><span class="hs-identifier">pairs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Tools.Set.html#mapSetM"><span class="hs-identifier hs-var">mapSetM</span></a><span> </span><a href="#local-6989586621679194669"><span class="hs-identifier hs-var">checkLoop</span></a><span> </span><a href="#local-6989586621679194672"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-72"></a><span>             </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Set.map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Set.filter</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679194673"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-73"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679194669"><a href="#local-6989586621679194669"><span class="hs-identifier">checkLoop</span></a></a><span> </span><a name="local-6989586621679194670"><a href="#local-6989586621679194670"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Graph.Interface.html#gisLoop"><span class="hs-identifier hs-var">gisLoop</span></a><span> </span><a href="#local-6989586621679194670"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194671"><a href="#local-6989586621679194671"><span class="hs-identifier">el</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194670"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194671"><span class="hs-identifier hs-var">el</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span> </span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="Math.Graph.Interface.html#GraphMonad"><span class="hs-identifier hs-type">GraphMonad</span></a><span> </span><a href="#local-6989586621679194637"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="ReversibleGraphMonad"><a href="Math.Graph.Interface.html#ReversibleGraphMonad"><span class="hs-identifier">ReversibleGraphMonad</span></a></a><span> </span><a name="local-6989586621679194637"><a href="#local-6989586621679194637"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679194638"><a href="#local-6989586621679194638"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-77"></a><span>   </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">ginverse</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">greversibleLinks</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-78"></a><span>   </span><a name="ginverse"><a href="Math.Graph.Interface.html#ginverse"><span class="hs-identifier">ginverse</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194637"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-79"></a><span>   </span><a name="greversibleLinks"><a href="Math.Graph.Interface.html#greversibleLinks"><span class="hs-identifier">greversibleLinks</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194637"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>   </span><a name="goneLaneLoops"><a href="Math.Graph.Interface.html#goneLaneLoops"><span class="hs-identifier">goneLaneLoops</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679194637"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>   </span><a name="gisOneLaneLoop"><a href="Math.Graph.Interface.html#gisOneLaneLoop"><span class="hs-identifier">gisOneLaneLoop</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679194638"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194637"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-82"></a><span>   </span><a name="local-8214565720323969496"><a href="Math.Graph.Interface.html#gisOneLaneLoop"><span class="hs-identifier">gisOneLaneLoop</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Graph.Interface.html#defaultGisOneLaneLoop"><span class="hs-identifier hs-var">defaultGisOneLaneLoop</span></a><span>
</span><a name="line-83"></a><span>   </span><a name="local-8214565720323969495"><a href="Math.Graph.Interface.html#goneLaneLoops"><span class="hs-identifier">goneLaneLoops</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Graph.Interface.html#defaultOneLaneLoops"><span class="hs-identifier hs-var">defaultOneLaneLoops</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span> </span><span class="hs-identifier">defaultOneLaneLoops</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679194665"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Math.Graph.Interface.html#ReversibleGraphMonad"><span class="hs-identifier hs-type">ReversibleGraphMonad</span></a><span> </span><a href="#local-6989586621679194666"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194665"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679194666"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679194665"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span> </span><a name="defaultOneLaneLoops"><a href="Math.Graph.Interface.html#defaultOneLaneLoops"><span class="hs-identifier">defaultOneLaneLoops</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-87"></a><span>    </span><a name="local-6989586621679194677"><a href="#local-6989586621679194677"><span class="hs-identifier">edges</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#gedges"><span class="hs-identifier hs-var">gedges</span></a><span>
</span><a name="line-88"></a><span>    </span><a name="local-6989586621679194678"><a href="#local-6989586621679194678"><span class="hs-identifier">pairs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Tools.Set.html#mapSetM"><span class="hs-identifier hs-var">mapSetM</span></a><span> </span><a href="#local-6989586621679194674"><span class="hs-identifier hs-var">checkOneLaneLoop</span></a><span> </span><a href="#local-6989586621679194677"><span class="hs-identifier hs-var">edges</span></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Set.map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Set.filter</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679194678"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679194674"><a href="#local-6989586621679194674"><span class="hs-identifier">checkOneLaneLoop</span></a></a><span> </span><a name="local-6989586621679194675"><a href="#local-6989586621679194675"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Graph.Interface.html#gisLoop"><span class="hs-identifier hs-var">gisLoop</span></a><span> </span><a href="#local-6989586621679194675"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194676"><a href="#local-6989586621679194676"><span class="hs-identifier">el</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194675"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679194676"><span class="hs-identifier hs-var">el</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span> </span><span class="hs-identifier">defaultGisEdgeBetween</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Math.Graph.Interface.html#GraphMonad"><span class="hs-identifier hs-type">GraphMonad</span></a><span> </span><a href="#local-6989586621679194663"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194664"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679194664"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194664"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194664"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194663"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-94"></a><span> </span><a name="defaultGisEdgeBetween"><a href="Math.Graph.Interface.html#defaultGisEdgeBetween"><span class="hs-identifier">defaultGisEdgeBetween</span></a></a><span> </span><a name="local-6989586621679194679"><a href="#local-6989586621679194679"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679194680"><a href="#local-6989586621679194680"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679194681"><a href="#local-6989586621679194681"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-95"></a><span>    </span><a name="local-6989586621679194682"><a href="#local-6989586621679194682"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#gsource"><span class="hs-identifier hs-var">gsource</span></a><span> </span><a href="#local-6989586621679194679"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-96"></a><span>    </span><a name="local-6989586621679194683"><a href="#local-6989586621679194683"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#gtarget"><span class="hs-identifier hs-var">gtarget</span></a><span> </span><a href="#local-6989586621679194679"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-97"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194680"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194682"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679194681"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194683"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span> </span><span class="hs-identifier">defaultGisOneLaneLoop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679194661"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Math.Graph.Interface.html#ReversibleGraphMonad"><span class="hs-identifier hs-type">ReversibleGraphMonad</span></a><span> </span><a href="#local-6989586621679194662"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194661"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679194661"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194662"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-101"></a><span> </span><a name="defaultGisOneLaneLoop"><a href="Math.Graph.Interface.html#defaultGisOneLaneLoop"><span class="hs-identifier">defaultGisOneLaneLoop</span></a></a><span> </span><a name="local-6989586621679194684"><a href="#local-6989586621679194684"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-102"></a><span>      </span><a name="local-6989586621679194685"><a href="#local-6989586621679194685"><span class="hs-identifier">re</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#ginverse"><span class="hs-identifier hs-var">ginverse</span></a><span> </span><a href="#local-6989586621679194684"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-103"></a><span>      </span><a name="local-6989586621679194686"><a href="#local-6989586621679194686"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#gisLoop"><span class="hs-identifier hs-var">gisLoop</span></a><span> </span><a href="#local-6989586621679194684"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-104"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194686"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679194684"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194685"><span class="hs-identifier hs-var">re</span></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span> </span><span class="hs-identifier">defaultGisReversibleEdgeBetween</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679194659"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Math.Graph.Interface.html#ReversibleGraphMonad"><span class="hs-identifier hs-type">ReversibleGraphMonad</span></a><span> </span><a href="#local-6989586621679194660"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679194659"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679194659"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194659"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194659"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194660"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-107"></a><span> </span><a name="defaultGisReversibleEdgeBetween"><a href="Math.Graph.Interface.html#defaultGisReversibleEdgeBetween"><span class="hs-identifier">defaultGisReversibleEdgeBetween</span></a></a><span> </span><a name="local-6989586621679194687"><a href="#local-6989586621679194687"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679194688"><a href="#local-6989586621679194688"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679194689"><a href="#local-6989586621679194689"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-108"></a><span>    </span><a name="local-6989586621679194690"><a href="#local-6989586621679194690"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#gisEdgeBetween"><span class="hs-identifier hs-var">gisEdgeBetween</span></a><span> </span><a href="#local-6989586621679194687"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679194688"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679194689"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-109"></a><span>    </span><a name="local-6989586621679194691"><a href="#local-6989586621679194691"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#ginverse"><span class="hs-identifier hs-var">ginverse</span></a><span> </span><a href="#local-6989586621679194687"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-110"></a><span>    </span><a name="local-6989586621679194692"><a href="#local-6989586621679194692"><span class="hs-identifier">yx</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Graph.Interface.html#gisEdgeBetween"><span class="hs-identifier hs-var">gisEdgeBetween</span></a><span> </span><a href="#local-6989586621679194691"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679194688"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679194689"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194690"><span class="hs-identifier hs-var">xy</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679194692"><span class="hs-identifier hs-var">yx</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a></pre></body></html>