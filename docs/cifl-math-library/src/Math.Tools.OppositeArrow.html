<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span> </span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances, Arrows, TypeFamilies, RankNTypes, PolyKinds, Safe #-}</span><span>
</span><span id="line-2"></span><span> </span><span class="hs-pragma">{-# OPTIONS_HADDOCK hide, prune #-}</span><span>
</span><span id="line-3"></span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math.Tools.OppositeArrow</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">id</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Category</span></span><span>
</span><span id="line-6"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>
</span><span id="line-7"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Math.Tools.Arrow.html"><span class="hs-identifier">Math.Tools.Arrow</span></a></span><span>
</span><span id="line-8"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Math.Tools.CoFunctor.html"><span class="hs-identifier">Math.Tools.CoFunctor</span></a></span><span>
</span><span id="line-9"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Contravariant</span></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span> </span><span class="hs-keyword">data</span><span> </span><span id="OpA"><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span></span><span> </span><span id="local-6989586621681196394"><span class="annot"><a href="#local-6989586621681196394"><span class="hs-identifier hs-type">arr</span></a></span></span><span> </span><span id="local-6989586621681196395"><span class="annot"><a href="#local-6989586621681196395"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621681196396"><span class="annot"><a href="#local-6989586621681196396"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OpA"><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runOpA"><span class="annot"><span class="annottext">forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
OpA arr a b -&gt; arr b a
</span><a href="Math.Tools.OppositeArrow.html#runOpA"><span class="hs-identifier hs-var hs-var">runOpA</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681196394"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196396"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681196413"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Category</span></span><span> </span><span class="annot"><a href="#local-6989586621681196413"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Category</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196413"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>    </span><span id="local-6989586621681196551"><span class="annot"><span class="annottext">id :: forall (a :: k). OpA c a a
</span><a href="#local-6989586621681196551"><span class="hs-identifier hs-var hs-var hs-var hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c a a -&gt; OpA c a a
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">c a a
forall (a :: k). c a a
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k). Category cat =&gt; cat a a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196554"><span class="annot"><span class="annottext">c c b
</span><a href="#local-6989586621681196554"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681196555"><span class="annot"><span class="annottext">. :: forall (b :: k) (c :: k) (a :: k).
OpA c b c -&gt; OpA c a b -&gt; OpA c a c
</span><a href="#local-6989586621681196555"><span class="hs-operator hs-var hs-var hs-var hs-var">.</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196557"><span class="annot"><span class="annottext">c b a
</span><a href="#local-6989586621681196557"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c c a -&gt; OpA c a c
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c b a
</span><a href="#local-6989586621681196557"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">c b a -&gt; c c b -&gt; c c a
forall (b :: k) (c :: k) (a :: k). c b c -&gt; c a b -&gt; c a c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">c c b
</span><a href="#local-6989586621681196554"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681196433"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArrowChoice</span></span><span> </span><span class="annot"><a href="#local-6989586621681196433"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Math.Tools.Arrow.html#CoArrow"><span class="hs-identifier hs-type">CoArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196433"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>    </span><span id="local-6989586621681196571"><span class="annot"><span class="annottext">coarr :: forall b a. (b -&gt; a) -&gt; OpA arr a b
</span><a href="#local-6989586621681196571"><span class="hs-identifier hs-var hs-var hs-var hs-var">coarr</span></a></span></span><span> </span><span id="local-6989586621681196573"><span class="annot"><span class="annottext">b -&gt; a
</span><a href="#local-6989586621681196573"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">arr b a -&gt; OpA arr a b
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">(arr b a -&gt; OpA arr a b) -&gt; arr b a -&gt; OpA arr a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; a) -&gt; arr b a
forall b c. (b -&gt; c) -&gt; arr b c
forall (a :: * -&gt; * -&gt; *) b c. Arrow a =&gt; (b -&gt; c) -&gt; a b c
</span><span class="hs-identifier hs-var">arr</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; a
</span><a href="#local-6989586621681196573"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span id="local-6989586621681196580"><span class="annot"><span class="annottext">coleft :: forall a b d. OpA arr a b -&gt; OpA arr (Either a d) (Either b d)
</span><a href="#local-6989586621681196580"><span class="hs-identifier hs-var hs-var hs-var hs-var">coleft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196582"><span class="annot"><span class="annottext">arr b a
</span><a href="#local-6989586621681196582"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">arr (Either b d) (Either a d) -&gt; OpA arr (Either a d) (Either b d)
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">(arr (Either b d) (Either a d)
 -&gt; OpA arr (Either a d) (Either b d))
-&gt; arr (Either b d) (Either a d)
-&gt; OpA arr (Either a d) (Either b d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">proc</span><span> </span><span id="local-6989586621681196583"><span class="annot"><span class="annottext">Either b d
</span><a href="#local-6989586621681196583"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either b d
</span><a href="#local-6989586621681196583"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-20"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681196584"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681196584"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681196585"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196585"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">arr b a
</span><a href="#local-6989586621681196582"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681196584"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-21"></span><span>                      </span><span class="annot"><span class="annottext">arr (Either a d) (Either a d)
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a d
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196585"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-22"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681196587"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621681196587"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">arr (Either a d) (Either a d)
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">d -&gt; Either a d
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621681196587"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span id="local-6989586621681196594"><span class="annot"><span class="annottext">coright :: forall a b d. OpA arr a b -&gt; OpA arr (Either d a) (Either d b)
</span><a href="#local-6989586621681196594"><span class="hs-identifier hs-var hs-var hs-var hs-var">coright</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196596"><span class="annot"><span class="annottext">arr b a
</span><a href="#local-6989586621681196596"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">arr (Either d b) (Either d a) -&gt; OpA arr (Either d a) (Either d b)
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">(arr (Either d b) (Either d a)
 -&gt; OpA arr (Either d a) (Either d b))
-&gt; arr (Either d b) (Either d a)
-&gt; OpA arr (Either d a) (Either d b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">proc</span><span> </span><span id="local-6989586621681196597"><span class="annot"><span class="annottext">Either d b
</span><a href="#local-6989586621681196597"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either d b
</span><a href="#local-6989586621681196597"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-24"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681196598"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621681196598"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">arr (Either d a) (Either d a)
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">d -&gt; Either d a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621681196598"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-25"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681196599"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681196599"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681196600"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196600"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">arr b a
</span><a href="#local-6989586621681196596"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681196599"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-26"></span><span>                       </span><span class="annot"><span class="annottext">arr (Either d a) (Either d a)
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either d a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196600"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span> </span><span id="local-6989586621681196453"><span id="local-6989586621681196454"><span id="local-6989586621681196455"><span class="annot"><a href="Math.Tools.OppositeArrow.html#cancelOp"><span class="hs-identifier hs-type">cancelOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196453"><span class="hs-identifier hs-type">cat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681196454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196455"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681196453"><span class="hs-identifier hs-type">cat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196455"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-30"></span><span> </span><span id="cancelOp"><span class="annot"><span class="annottext">cancelOp :: forall {k} {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k).
OpA (OpA cat) a b -&gt; cat a b
</span><a href="Math.Tools.OppositeArrow.html#cancelOp"><span class="hs-identifier hs-var hs-var">cancelOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196602"><span class="annot"><span class="annottext">cat a b
</span><a href="#local-6989586621681196602"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">cat a b
</span><a href="#local-6989586621681196602"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span> </span><span id="local-6989586621681196462"><span id="local-6989586621681196463"><span id="local-6989586621681196464"><span id="local-6989586621681196465"><span id="local-6989586621681196466"><span class="annot"><a href="Math.Tools.OppositeArrow.html#inverseImageA"><span class="hs-identifier hs-type">inverseImageA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Category</span></span><span> </span><span class="annot"><a href="#local-6989586621681196462"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681196463"><span class="hs-identifier hs-type">arr'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681196462"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196464"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196465"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681196463"><span class="hs-identifier hs-type">arr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196462"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196466"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196465"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196462"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196466"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196464"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-34"></span><span> </span><span id="inverseImageA"><span class="annot"><span class="annottext">inverseImageA :: forall {k} (arr :: k -&gt; k -&gt; *) (arr' :: * -&gt; * -&gt; *) (a :: k)
       (b :: k) (c :: k).
(Category arr, Arrow arr') =&gt;
arr a b -&gt; arr' (OpA arr c b) (OpA arr c a)
</span><a href="Math.Tools.OppositeArrow.html#inverseImageA"><span class="hs-identifier hs-var hs-var">inverseImageA</span></a></span></span><span> </span><span id="local-6989586621681196611"><span class="annot"><span class="annottext">arr a b
</span><a href="#local-6989586621681196611"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">proc</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196612"><span class="annot"><span class="annottext">arr b c
</span><a href="#local-6989586621681196612"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">arr' (OpA arr c a) (OpA arr c a)
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">arr a c -&gt; OpA arr c a
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">(arr a c -&gt; OpA arr c a) -&gt; arr a c -&gt; OpA arr c a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">arr b c
</span><a href="#local-6989586621681196612"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">arr b c -&gt; arr a b -&gt; arr a c
forall (b :: k) (c :: k) (a :: k). arr b c -&gt; arr a b -&gt; arr a c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">arr a b
</span><a href="#local-6989586621681196611"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681196486"><span id="local-6989586621681196487"><span id="local-6989586621681196488"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Category</span></span><span> </span><span class="annot"><a href="#local-6989586621681196486"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681196487"><span class="hs-identifier hs-type">arr'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Math.Tools.Arrow.html#OpArrow"><span class="hs-identifier hs-type">OpArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196486"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681196486"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196487"><span class="hs-identifier hs-type">arr'</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>    </span><span id="local-6989586621681196625"><span class="annot"><span class="annottext">inverse_imageA :: forall (a :: k) (b :: k).
arr a b -&gt; arr' (OpA arr a b) (OpA arr a a)
</span><a href="#local-6989586621681196625"><span class="hs-identifier hs-var hs-var hs-var hs-var">inverse_imageA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">arr a b -&gt; arr' (OpA arr a b) (OpA arr a a)
forall {k} (arr :: k -&gt; k -&gt; *) (arr' :: * -&gt; * -&gt; *) (a :: k)
       (b :: k) (c :: k).
(Category arr, Arrow arr') =&gt;
arr a b -&gt; arr' (OpA arr c b) (OpA arr c a)
</span><a href="Math.Tools.OppositeArrow.html#inverseImageA"><span class="hs-identifier hs-var">inverseImageA</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681196499"><span id="local-6989586621681196500"><span id="local-6989586621681196630"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681196499"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Contravariant</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196499"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196500"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>    </span><span id="local-6989586621681196637"><span class="annot"><span class="annottext">contramap :: forall a' a. (a' -&gt; a) -&gt; OpA arr a a -&gt; OpA arr a a'
</span><a href="#local-6989586621681196637"><span class="hs-identifier hs-var hs-var hs-var hs-var">contramap</span></a></span></span><span> </span><span id="local-6989586621681196639"><span class="annot"><span class="annottext">a' -&gt; a
</span><a href="#local-6989586621681196639"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196640"><span class="annot"><span class="annottext">arr a a
</span><a href="#local-6989586621681196640"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">arr a' a -&gt; OpA arr a a'
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">arr a a
</span><a href="#local-6989586621681196640"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">arr a a -&gt; arr a' a -&gt; arr a' a
forall b c a. arr b c -&gt; arr a b -&gt; arr a c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a' -&gt; a) -&gt; arr a' a
forall b c. (b -&gt; c) -&gt; arr b c
forall (a :: * -&gt; * -&gt; *) b c. Arrow a =&gt; (b -&gt; c) -&gt; a b c
</span><span class="hs-identifier hs-var">arr</span></span><span> </span><span class="annot"><span class="annottext">a' -&gt; a
</span><a href="#local-6989586621681196639"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span> </span><span class="hs-keyword">data</span><span> </span><span id="Empty"><span class="annot"><a href="Math.Tools.OppositeArrow.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span></span><span> </span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span> </span><span class="annot"><span class="hs-comment">-- | &lt;https://en.wikipedia.org/wiki/Monoidal_category&gt;</span></span><span>
</span><span id="line-45"></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Math.Tools.Arrow.html#MonoidalCategory"><span class="hs-identifier hs-type">MonoidalCategory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Prod"><span class="annot"><a href="Math.Tools.Arrow.html#Prod"><span class="hs-identifier hs-var">Prod</span></a></span></span><span> </span><span id="local-6989586621681196654"><span id="local-6989586621681196655"><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681196654"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196655"><span class="hs-identifier hs-type">b</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621681196654"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681196655"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="MUnit"><span class="annot"><a href="Math.Tools.Arrow.html#MUnit"><span class="hs-identifier hs-var">MUnit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Math.Tools.OppositeArrow.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196658"><span class="annot"><span class="annottext">b -&gt; a
</span><a href="#local-6989586621681196658"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681196659"><span class="annot"><span class="annottext">-*- :: forall a b a' b'.
OpA (-&gt;) a b
-&gt; OpA (-&gt;) a' b'
-&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) a a') (Prod (OpA (-&gt;)) b b')
</span><a href="#local-6989586621681196659"><span class="hs-operator hs-var hs-var hs-var hs-var">-*-</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-type">OpA</span></a></span><span> </span><span id="local-6989586621681196661"><span class="annot"><span class="annottext">b' -&gt; a'
</span><a href="#local-6989586621681196661"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prod (OpA (-&gt;)) b b' -&gt; Prod (OpA (-&gt;)) a a')
-&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) a a') (Prod (OpA (-&gt;)) b b')
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">((Prod (OpA (-&gt;)) b b' -&gt; Prod (OpA (-&gt;)) a a')
 -&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) a a') (Prod (OpA (-&gt;)) b b'))
-&gt; (Prod (OpA (-&gt;)) b b' -&gt; Prod (OpA (-&gt;)) a a')
-&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) a a') (Prod (OpA (-&gt;)) b b')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; a
</span><a href="#local-6989586621681196658"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; a) -&gt; (b' -&gt; a') -&gt; Either b b' -&gt; Either a a'
forall b c b' c'.
(b -&gt; c) -&gt; (b' -&gt; c') -&gt; Either b b' -&gt; Either c c'
forall (a :: * -&gt; * -&gt; *) b c b' c'.
ArrowChoice a =&gt;
a b c -&gt; a b' c' -&gt; a (Either b b') (Either c c')
</span><span class="hs-operator hs-var">+++</span></span><span> </span><span class="annot"><span class="annottext">b' -&gt; a'
</span><a href="#local-6989586621681196661"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621681196669"><span class="annot"><span class="annottext">unleftunitor :: forall a. OpA (-&gt;) a (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a)
</span><a href="#local-6989586621681196669"><span class="hs-identifier hs-var hs-var hs-var hs-var">unleftunitor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a -&gt; a)
-&gt; OpA (-&gt;) a (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a)
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">((Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a -&gt; a)
 -&gt; OpA (-&gt;) a (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a))
-&gt; (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a -&gt; a)
-&gt; OpA (-&gt;) a (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">proc</span><span> </span><span id="local-6989586621681196671"><span class="annot"><span class="annottext">Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a
</span><a href="#local-6989586621681196671"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a
</span><a href="#local-6989586621681196671"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681196672"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196672"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196672"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621681196678"><span class="annot"><span class="annottext">unrightunitor :: forall a. OpA (-&gt;) a (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))))
</span><a href="#local-6989586621681196678"><span class="hs-identifier hs-var hs-var hs-var hs-var">unrightunitor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))) -&gt; a)
-&gt; OpA (-&gt;) a (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))))
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">((Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))) -&gt; a)
 -&gt; OpA (-&gt;) a (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;)))))
-&gt; (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))) -&gt; a)
-&gt; OpA (-&gt;) a (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">proc</span><span> </span><span id="local-6989586621681196680"><span class="annot"><span class="annottext">Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;)))
</span><a href="#local-6989586621681196680"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;)))
</span><a href="#local-6989586621681196680"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681196681"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196681"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196681"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621681196686"><span class="annot"><span class="annottext">leftunitor :: forall a. OpA (-&gt;) (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a) a
</span><a href="#local-6989586621681196686"><span class="hs-identifier hs-var hs-var hs-var hs-var">leftunitor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a)
-&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a) a
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a)
 -&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a) a)
-&gt; (a -&gt; Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a)
-&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">proc</span><span> </span><span id="local-6989586621681196688"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196688"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Empty a -&gt; Either Empty a
Either Empty a -&gt; Prod (OpA (-&gt;)) (MUnit (OpA (-&gt;))) a
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either Empty a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196688"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span id="local-6989586621681196693"><span class="annot"><span class="annottext">rightunitor :: forall a. OpA (-&gt;) (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;)))) a
</span><a href="#local-6989586621681196693"><span class="hs-identifier hs-var hs-var hs-var hs-var">rightunitor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))))
-&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;)))) a
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))))
 -&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;)))) a)
-&gt; (a -&gt; Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;))))
-&gt; OpA (-&gt;) (Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;)))) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">proc</span><span> </span><span id="local-6989586621681196695"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196695"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a Empty -&gt; Either a Empty
Either a Empty -&gt; Prod (OpA (-&gt;)) a (MUnit (OpA (-&gt;)))
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a Empty
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196695"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621681196703"><span class="annot"><span class="annottext">monoidal_assoc :: forall a b c.
OpA
  (-&gt;)
  (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
  (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
</span><a href="#local-6989586621681196703"><span class="hs-identifier hs-var hs-var hs-var hs-var">monoidal_assoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)
 -&gt; Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
-&gt; OpA
     (-&gt;)
     (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
     (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">((Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)
  -&gt; Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
 -&gt; OpA
      (-&gt;)
      (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
      (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)))
-&gt; (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)
    -&gt; Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
-&gt; OpA
     (-&gt;)
     (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
     (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">proc</span><span> </span><span id="local-6989586621681196705"><span class="annot"><span class="annottext">Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)
</span><a href="#local-6989586621681196705"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)
</span><a href="#local-6989586621681196705"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-54"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681196706"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196706"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (Either a b) c -&gt; Either (Either a b) c
Either (Either a b) c -&gt; Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; Either (Either a b) c
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196706"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681196707"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681196707"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (Either a b) c -&gt; Either (Either a b) c
Either (Either a b) c -&gt; Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; Either (Either a b) c
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681196707"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681196708"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621681196708"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (Either a b) c -&gt; Either (Either a b) c
Either (Either a b) c -&gt; Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">c -&gt; Either (Either a b) c
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621681196708"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621681196716"><span class="annot"><span class="annottext">monoidal_deassoc :: forall a b c.
OpA
  (-&gt;)
  (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
  (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
</span><a href="#local-6989586621681196716"><span class="hs-identifier hs-var hs-var hs-var hs-var">monoidal_deassoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c
 -&gt; Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
-&gt; OpA
     (-&gt;)
     (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
     (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
forall {k} {k} (arr :: k -&gt; k -&gt; *) (a :: k) (b :: k).
arr b a -&gt; OpA arr a b
</span><a href="Math.Tools.OppositeArrow.html#OpA"><span class="hs-identifier hs-var">OpA</span></a></span><span> </span><span class="annot"><span class="annottext">((Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c
  -&gt; Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
 -&gt; OpA
      (-&gt;)
      (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
      (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c))
-&gt; (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c
    -&gt; Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
-&gt; OpA
     (-&gt;)
     (Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c))
     (Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">proc</span><span> </span><span id="local-6989586621681196718"><span class="annot"><span class="annottext">Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c
</span><a href="#local-6989586621681196718"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prod (OpA (-&gt;)) (Prod (OpA (-&gt;)) a b) c
</span><a href="#local-6989586621681196718"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-58"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681196719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196719"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (Either b c) -&gt; Either a (Either b c)
Either a (Either b c) -&gt; Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a (Either b c)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681196719"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-59"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681196720"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681196720"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (Either b c) -&gt; Either a (Either b c)
Either a (Either b c) -&gt; Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">Either b c -&gt; Either a (Either b c)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either b c
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681196720"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681196721"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621681196721"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (Either b c) -&gt; Either a (Either b c)
Either a (Either b c) -&gt; Prod (OpA (-&gt;)) a (Prod (OpA (-&gt;)) b c)
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">Either b c -&gt; Either a (Either b c)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Either b c
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621681196721"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span></pre></body></html>