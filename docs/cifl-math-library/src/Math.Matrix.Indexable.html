<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span> </span><span class="hs-pragma">{-# LANGUAGE TypeOperators, Safe #-}</span><span>
</span><span id="line-2"></span><span> </span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span> </span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-4"></span><span> </span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span> </span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-6"></span><span> </span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-7"></span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math.Matrix.Indexable</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-9"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Category</span></span><span>
</span><span id="line-11"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html"><span class="hs-identifier">Math.Matrix.Interface</span></a></span><span>
</span><span id="line-12"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Math.Tools.I.html"><span class="hs-identifier">Math.Tools.I</span></a></span><span>
</span><span id="line-13"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Math.Tools.Isomorphism.html"><span class="hs-identifier">Math.Tools.Isomorphism</span></a></span><span>
</span><span id="line-14"></span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Math.Tools.Arrow.html"><span class="hs-identifier">Math.Tools.Arrow</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681274561"><span id="local-6989586621681274675"><span id="local-6989586621681274679"><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="Math.Tools.I.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274561"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>   </span><span id="local-6989586621681274683"><span class="annot"><span class="annottext">diagonalProjections :: I (Index I a)
</span><a href="#local-6989586621681274683"><span class="hs-identifier hs-var hs-var hs-var hs-var">diagonalProjections</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Index I a -&gt; I (Index I a)
forall a. a -&gt; I a
</span><a href="Math.Tools.I.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(I a -&gt; a) -&gt; (a -&gt; I a -&gt; I a) -&gt; Index I a
forall (m :: * -&gt; *) a.
(m a -&gt; a) -&gt; (a -&gt; m a -&gt; m a) -&gt; Index m a
</span><a href="Math.Matrix.Interface.html#MakeIndex"><span class="hs-identifier hs-var">MakeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">I a -&gt; a
forall a. I a -&gt; a
</span><a href="Math.Tools.I.html#unI"><span class="hs-identifier hs-var">unI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681274688"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274688"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Tools.I.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; I a
forall a. a -&gt; I a
</span><a href="Math.Tools.I.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274688"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>   </span><span id="local-6989586621681274695"><span class="annot"><span class="annottext">indexableIndices :: Integral a =&gt; I a
</span><a href="#local-6989586621681274695"><span class="hs-identifier hs-var hs-var hs-var hs-var">indexableIndices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; I a
forall a. a -&gt; I a
</span><a href="Math.Tools.I.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621681274577"><span id="local-6989586621681274578"><span id="local-6989586621681274579"><span id="local-6989586621681274706"><span id="local-6989586621681274712"><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681274572"><span class="annot"><a href="#local-6989586621681274572"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274577"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274572"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681274573"><span class="annot"><a href="#local-6989586621681274573"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274578"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274573"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681274577"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274578"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681274579"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>   </span><span id="local-6989586621681274725"><span class="annot"><span class="annottext">diagonalProjections :: (:*:) f g (Index (f :*: g) a)
</span><a href="Math.Matrix.Interface.html#diagonalProjections"><span class="hs-identifier hs-var hs-var hs-var hs-var">diagonalProjections</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(:*:) f g (Index (f :*: g) a)
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(forall b. Indexable f b, forall c. Indexable g c) =&gt;
(:*:) f g (Index (f :*: g) a)
</span><a href="Math.Matrix.Indexable.html#indexableMatrixProjections"><span class="hs-identifier hs-var">indexableMatrixProjections</span></a></span><span>
</span><span id="line-22"></span><span>   </span><span id="local-6989586621681274744"><span class="annot"><span class="annottext">indexableIndices :: Integral a =&gt; (:*:) f g a
</span><a href="Math.Matrix.Interface.html#indexableIndices"><span class="hs-identifier hs-var hs-var hs-var hs-var">indexableIndices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; f a -&gt; g a -&gt; (:*:) f g a
forall (m :: * -&gt; *) (n :: * -&gt; *) a b c.
(Functor m, Functor n) =&gt;
(a -&gt; b -&gt; c) -&gt; m a -&gt; n b -&gt; (:*:) m n c
</span><a href="Math.Matrix.Interface.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681274746"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274746"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681274747"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274747"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274746"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274747"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274746"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274747"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274746"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f a
forall (m :: * -&gt; *) a. (Indexable m a, Integral a) =&gt; m a
</span><a href="Math.Matrix.Interface.html#indexableIndices"><span class="hs-identifier hs-var">indexableIndices</span></a></span><span> </span><span class="annot"><span class="annottext">g a
forall (m :: * -&gt; *) a. (Indexable m a, Integral a) =&gt; m a
</span><a href="Math.Matrix.Interface.html#indexableIndices"><span class="hs-identifier hs-var">indexableIndices</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-comment">-- indexable_diagonal :: (Indexable f) =&gt; (f :*: f) a -&gt; a -&gt; f a</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-comment">-- indexable_diagonal ~(Matrix m) a = index_project (diagonal_projections a) &lt;*&gt; m</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-comment">-- indexable_apply :: (Indexable f) =&gt; (f :*: f) (a -&gt; b) -&gt; f a -&gt; f b</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-comment">-- indexable_apply ~(Matrix m) x = index_project (diagonal_projections x) &lt;*&gt; m &lt;*&gt; x</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-comment">-- indexable_transpose :: (Functor f, Functor g, Indexable g) =&gt;</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-comment">--                        (f :*: g) a -&gt; a -&gt; (g :*: f) a</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-comment">-- indexable_transpose ~(Matrix m) n = matrix id (index_project (diagonal_projections n)) m</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-comment">-- indexable_matrix_projections :: (Indexable f, Indexable g)</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-comment">--                              =&gt; a -&gt; b -&gt; (f :*: g) (Index (f :*: g) a)</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-comment">-- indexable_matrix_projections ::</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">--    a -&gt; a -&gt; (m :*: I) (m a :==: I a)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span> </span><span id="local-6989586621681274751"><span id="local-6989586621681274752"><span id="local-6989586621681274753"><span class="annot"><a href="Math.Matrix.Indexable.html#indexableMatrixProjections"><span class="hs-identifier hs-type">indexableMatrixProjections</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-41"></span><span>   </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681274587"><span class="annot"><a href="#local-6989586621681274587"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274587"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681274589"><span class="annot"><a href="#local-6989586621681274589"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274752"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274589"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681274751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274752"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681274751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274752"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681274753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-43"></span><span> </span><span id="indexableMatrixProjections"><span class="annot"><span class="annottext">indexableMatrixProjections :: forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(forall b. Indexable f b, forall c. Indexable g c) =&gt;
(:*:) f g (Index (f :*: g) a)
</span><a href="Math.Matrix.Indexable.html#indexableMatrixProjections"><span class="hs-identifier hs-var hs-var">indexableMatrixProjections</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Index m (n a) -&gt; Index n a -&gt; Index (m :*: n) a)
-&gt; m (Index m (n a))
-&gt; n (Index n a)
-&gt; (:*:) m n (Index (m :*: n) a)
forall (m :: * -&gt; *) (n :: * -&gt; *) a b c.
(Functor m, Functor n) =&gt;
(a -&gt; b -&gt; c) -&gt; m a -&gt; n b -&gt; (:*:) m n c
</span><a href="Math.Matrix.Interface.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Index m (n a) -&gt; Index n a -&gt; Index (m :*: n) a
forall {m :: * -&gt; *} {g :: * -&gt; *} {a}.
Index m (g a) -&gt; Index g a -&gt; Index (m :*: g) a
</span><a href="#local-6989586621681274764"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">m (Index m (n a))
forall (m :: * -&gt; *) a. Indexable m a =&gt; m (Index m a)
</span><a href="Math.Matrix.Interface.html#diagonalProjections"><span class="hs-identifier hs-var">diagonalProjections</span></a></span><span> </span><span class="annot"><span class="annottext">n (Index n a)
forall (m :: * -&gt; *) a. Indexable m a =&gt; m (Index m a)
</span><a href="Math.Matrix.Interface.html#diagonalProjections"><span class="hs-identifier hs-var">diagonalProjections</span></a></span><span>
</span><span id="line-44"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681274764"><span class="annot"><span class="annottext">comp :: Index m (g a) -&gt; Index g a -&gt; Index (m :*: g) a
</span><a href="#local-6989586621681274764"><span class="hs-identifier hs-var hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621681274768"><span class="annot"><span class="annottext">Index m (g a)
</span><a href="#local-6989586621681274768"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681274769"><span class="annot"><span class="annottext">Index g a
</span><a href="#local-6989586621681274769"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((:*:) m g a -&gt; a)
-&gt; (a -&gt; (:*:) m g a -&gt; (:*:) m g a) -&gt; Index (m :*: g) a
forall (m :: * -&gt; *) a.
(m a -&gt; a) -&gt; (a -&gt; m a -&gt; m a) -&gt; Index m a
</span><a href="Math.Matrix.Interface.html#MakeIndex"><span class="hs-identifier hs-var">MakeIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index g a -&gt; g a -&gt; a
forall (m :: * -&gt; *) a. Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Interface.html#scalarProjection"><span class="hs-identifier hs-var">scalarProjection</span></a></span><span> </span><span class="annot"><span class="annottext">Index g a
</span><a href="#local-6989586621681274769"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">(g a -&gt; a) -&gt; ((:*:) m g a -&gt; g a) -&gt; (:*:) m g a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index m (g a) -&gt; m (g a) -&gt; g a
forall (m :: * -&gt; *) a. Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Interface.html#scalarProjection"><span class="hs-identifier hs-var">scalarProjection</span></a></span><span> </span><span class="annot"><span class="annottext">Index m (g a)
</span><a href="#local-6989586621681274768"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(m (g a) -&gt; g a) -&gt; ((:*:) m g a -&gt; m (g a)) -&gt; (:*:) m g a -&gt; g a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(:*:) m g a -&gt; m (g a)
forall {k1} {k2} (f :: k1 -&gt; *) (g :: k2 -&gt; k1) (a :: k2).
(:*:) f g a -&gt; f (g a)
</span><a href="Math.Matrix.Interface.html#cells"><span class="hs-identifier hs-var">cells</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>                              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681274773"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274773"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span id="local-6989586621681274775"><span class="annot"><span class="annottext">m (g a)
</span><a href="#local-6989586621681274775"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (g a) -&gt; (:*:) m g a
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; (:*:) f g a
</span><a href="Math.Matrix.Interface.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="annot"><span class="annottext">(m (g a) -&gt; (:*:) m g a) -&gt; m (g a) -&gt; (:*:) m g a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Index m (g a) -&gt; g a -&gt; m (g a) -&gt; m (g a)
forall (m :: * -&gt; *) a. Index m a -&gt; a -&gt; m a -&gt; m a
</span><a href="Math.Matrix.Interface.html#modifyVector"><span class="hs-identifier hs-var">modifyVector</span></a></span><span> </span><span class="annot"><span class="annottext">Index m (g a)
</span><a href="#local-6989586621681274768"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index g a -&gt; a -&gt; g a -&gt; g a
forall (m :: * -&gt; *) a. Index m a -&gt; a -&gt; m a -&gt; m a
</span><a href="Math.Matrix.Interface.html#modifyVector"><span class="hs-identifier hs-var">modifyVector</span></a></span><span> </span><span class="annot"><span class="annottext">Index g a
</span><a href="#local-6989586621681274769"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681274773"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index m (g a) -&gt; m (g a) -&gt; g a
forall (m :: * -&gt; *) a. Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Interface.html#scalarProjection"><span class="hs-identifier hs-var">scalarProjection</span></a></span><span> </span><span class="annot"><span class="annottext">Index m (g a)
</span><a href="#local-6989586621681274768"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m (g a)
</span><a href="#local-6989586621681274775"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (g a)
</span><a href="#local-6989586621681274775"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-comment">--  matrix (\f g -&gt; (unI &lt;-&gt; I) . amap g . f . (cells &lt;-&gt; Matrix))</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-comment">--        diagonalProjections</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-comment">--        diagonalProjections</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-comment">-- transposedIndices :: (Indexable f, Indexable g) =&gt; a -&gt; b -&gt; (g :*: f) (Index (f :*: g) a)</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-comment">-- transposedIndices a b = fmap (. (cells &lt;-&gt; Matrix)) $ matrix (.) (diagonal_projections a) (diagonal_projections b)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-comment">-- join_matrix :: (Indexable f, Indexable g) </span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">--             =&gt; (f :*: g) ((f :*: g) b) -&gt; b -&gt; c -&gt; (f :*: g) b</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-comment">-- join_matrix m a c = fmap (\ (Iso s p) -&gt; (s &lt;*&gt; m) &lt;-&gt; (p &lt;*&gt; m)) $</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-comment">--                        indexable_matrix_projections a c</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-comment">-- join_matrix m = cells (fmap cells m)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span> </span><span id="local-6989586621681274617"><span id="local-6989586621681274618"><span class="annot"><a href="Math.Matrix.Indexable.html#applyIndex"><span class="hs-identifier hs-type">applyIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274618"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274618"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681274617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274618"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681274618"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-66"></span><span> </span><span id="applyIndex"><span class="annot"><span class="annottext">applyIndex :: forall (m :: * -&gt; *) a. Indexable m a =&gt; Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Indexable.html#applyIndex"><span class="hs-identifier hs-var hs-var">applyIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Index m a -&gt; m a -&gt; a
forall (m :: * -&gt; *) a. Indexable m a =&gt; Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Interface.html#indexProject"><span class="hs-identifier hs-var">indexProject</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span> </span><span id="local-6989586621681274621"><span id="local-6989586621681274622"><span id="local-6989586621681274623"><span class="annot"><a href="Math.Matrix.Indexable.html#with"><span class="hs-identifier hs-type">with</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274621"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681274622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274621"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681274623"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681274621"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274623"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-69"></span><span> </span><span id="with"><span class="annot"><span class="annottext">with :: forall (f :: * -&gt; *) a b.
(Indexable f a, Num a) =&gt;
(Index f a -&gt; b) -&gt; f b
</span><a href="Math.Matrix.Indexable.html#with"><span class="hs-identifier hs-var hs-var">with</span></a></span></span><span> </span><span id="local-6989586621681274787"><span class="annot"><span class="annottext">Index f a -&gt; b
</span><a href="#local-6989586621681274787"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Index f a -&gt; b) -&gt; f (Index f a) -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">liftA</span></span><span> </span><span class="annot"><span class="annottext">Index f a -&gt; b
</span><a href="#local-6989586621681274787"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Index f a) -&gt; f b) -&gt; f (Index f a) -&gt; f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (Index f a)
forall (m :: * -&gt; *) a. Indexable m a =&gt; m (Index m a)
</span><a href="Math.Matrix.Interface.html#diagonalProjections"><span class="hs-identifier hs-var">diagonalProjections</span></a></span><span>
</span><span id="line-70"></span><span> </span><span>
</span><span id="line-71"></span><span> </span><span id="local-6989586621681274630"><span id="local-6989586621681274631"><span id="local-6989586621681274632"><span id="local-6989586621681274633"><span id="local-6989586621681274634"><span class="annot"><a href="Math.Matrix.Indexable.html#with2"><span class="hs-identifier hs-type">with2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274631"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274632"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274633"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681274631"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681274633"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274631"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274632"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274633"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681274634"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681274630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274632"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681274634"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span></span><span>
</span><span id="line-73"></span><span> </span><span id="with2"><span class="annot"><span class="annottext">with2 :: forall (f :: * -&gt; *) a (g :: * -&gt; *) b c.
(Indexable f a, Indexable g b, Num a, Num b) =&gt;
(Index f a -&gt; Index g b -&gt; c) -&gt; (:*:) f g c
</span><a href="Math.Matrix.Indexable.html#with2"><span class="hs-identifier hs-var hs-var">with2</span></a></span></span><span> </span><span id="local-6989586621681274798"><span class="annot"><span class="annottext">Index f a -&gt; Index g b -&gt; c
</span><a href="#local-6989586621681274798"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (g c) -&gt; (:*:) f g c
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; (:*:) f g a
</span><a href="Math.Matrix.Interface.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="annot"><span class="annottext">(f (g c) -&gt; (:*:) f g c) -&gt; f (g c) -&gt; (:*:) f g c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Index f a -&gt; g c) -&gt; f (g c)
forall (f :: * -&gt; *) a b.
(Indexable f a, Num a) =&gt;
(Index f a -&gt; b) -&gt; f b
</span><a href="Math.Matrix.Indexable.html#with"><span class="hs-identifier hs-var">with</span></a></span><span> </span><span class="annot"><span class="annottext">((Index f a -&gt; g c) -&gt; f (g c)) -&gt; (Index f a -&gt; g c) -&gt; f (g c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681274799"><span class="annot"><span class="annottext">Index f a
</span><a href="#local-6989586621681274799"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Index g b -&gt; c) -&gt; g c
forall (f :: * -&gt; *) a b.
(Indexable f a, Num a) =&gt;
(Index f a -&gt; b) -&gt; f b
</span><a href="Math.Matrix.Indexable.html#with"><span class="hs-identifier hs-var">with</span></a></span><span> </span><span class="annot"><span class="annottext">((Index g b -&gt; c) -&gt; g c) -&gt; (Index g b -&gt; c) -&gt; g c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681274800"><span class="annot"><span class="annottext">Index g b
</span><a href="#local-6989586621681274800"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Index f a -&gt; Index g b -&gt; c
</span><a href="#local-6989586621681274798"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Index f a
</span><a href="#local-6989586621681274799"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Index g b
</span><a href="#local-6989586621681274800"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span> </span><span id="local-6989586621681274640"><span id="local-6989586621681274641"><span id="local-6989586621681274642"><span id="local-6989586621681274643"><span id="local-6989586621681274644"><span id="local-6989586621681274645"><span id="local-6989586621681274646"><span class="annot"><a href="Math.Matrix.Indexable.html#with3"><span class="hs-identifier hs-type">with3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274641"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274642"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274643"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274644"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274645"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681274641"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681274643"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681274645"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274641"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274642"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274643"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274644"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274645"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681274646"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681274640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681274642"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274644"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681274646"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-77"></span><span> </span><span id="with3"><span class="annot"><span class="annottext">with3 :: forall (f :: * -&gt; *) a (g :: * -&gt; *) b (h :: * -&gt; *) c d.
(Indexable f a, Indexable g b, Indexable h c, Num a, Num b,
 Num c) =&gt;
(Index f a -&gt; Index g b -&gt; Index h c -&gt; d) -&gt; (:*:) f (g :*: h) d
</span><a href="Math.Matrix.Indexable.html#with3"><span class="hs-identifier hs-var hs-var">with3</span></a></span></span><span> </span><span id="local-6989586621681274814"><span class="annot"><span class="annottext">Index f a -&gt; Index g b -&gt; Index h c -&gt; d
</span><a href="#local-6989586621681274814"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f ((:*:) g h d) -&gt; (:*:) f (g :*: h) d
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; (:*:) f g a
</span><a href="Math.Matrix.Interface.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="annot"><span class="annottext">(f ((:*:) g h d) -&gt; (:*:) f (g :*: h) d)
-&gt; f ((:*:) g h d) -&gt; (:*:) f (g :*: h) d
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Index f a -&gt; (:*:) g h d) -&gt; f ((:*:) g h d)
forall (f :: * -&gt; *) a b.
(Indexable f a, Num a) =&gt;
(Index f a -&gt; b) -&gt; f b
</span><a href="Math.Matrix.Indexable.html#with"><span class="hs-identifier hs-var">with</span></a></span><span> </span><span class="annot"><span class="annottext">((Index f a -&gt; (:*:) g h d) -&gt; f ((:*:) g h d))
-&gt; (Index f a -&gt; (:*:) g h d) -&gt; f ((:*:) g h d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681274815"><span class="annot"><span class="annottext">Index f a
</span><a href="#local-6989586621681274815"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">g (h d) -&gt; (:*:) g h d
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; (:*:) f g a
</span><a href="Math.Matrix.Interface.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="annot"><span class="annottext">(g (h d) -&gt; (:*:) g h d) -&gt; g (h d) -&gt; (:*:) g h d
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-78"></span><span>                    </span><span class="annot"><span class="annottext">(Index g b -&gt; h d) -&gt; g (h d)
forall (f :: * -&gt; *) a b.
(Indexable f a, Num a) =&gt;
(Index f a -&gt; b) -&gt; f b
</span><a href="Math.Matrix.Indexable.html#with"><span class="hs-identifier hs-var">with</span></a></span><span> </span><span class="annot"><span class="annottext">((Index g b -&gt; h d) -&gt; g (h d)) -&gt; (Index g b -&gt; h d) -&gt; g (h d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681274816"><span class="annot"><span class="annottext">Index g b
</span><a href="#local-6989586621681274816"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>                    </span><span class="annot"><span class="annottext">(Index h c -&gt; d) -&gt; h d
forall (f :: * -&gt; *) a b.
(Indexable f a, Num a) =&gt;
(Index f a -&gt; b) -&gt; f b
</span><a href="Math.Matrix.Indexable.html#with"><span class="hs-identifier hs-var">with</span></a></span><span> </span><span class="annot"><span class="annottext">((Index h c -&gt; d) -&gt; h d) -&gt; (Index h c -&gt; d) -&gt; h d
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681274817"><span class="annot"><span class="annottext">Index h c
</span><a href="#local-6989586621681274817"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Index f a -&gt; Index g b -&gt; Index h c -&gt; d
</span><a href="#local-6989586621681274814"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Index f a
</span><a href="#local-6989586621681274815"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Index g b
</span><a href="#local-6989586621681274816"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Index h c
</span><a href="#local-6989586621681274817"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-comment">-- kronecker_delta :: (forall b. (Eq b) =&gt; Indexable f b, Num a) =&gt; (f :*: f) a</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-comment">-- kronecker_delta = matrix (\i j -&gt; if i == j then 1 else 0) indexable_indices indexable_indices</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span> </span><span id="local-6989586621681274654"><span class="annot"><a href="Math.Matrix.Indexable.html#equalIndices"><span class="hs-identifier hs-type">equalIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274654"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274654"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274654"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-85"></span><span> </span><span id="equalIndices"><span class="annot"><span class="annottext">equalIndices :: forall (f :: * -&gt; *).
Indexable f Int =&gt;
Index f Int -&gt; Index f Int -&gt; Bool
</span><a href="Math.Matrix.Indexable.html#equalIndices"><span class="hs-identifier hs-var hs-var">equalIndices</span></a></span></span><span> </span><span id="local-6989586621681274829"><span class="annot"><span class="annottext">Index f Int
</span><a href="#local-6989586621681274829"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681274830"><span class="annot"><span class="annottext">Index f Int
</span><a href="#local-6989586621681274830"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Index f Int
</span><a href="#local-6989586621681274829"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Index f Int -&gt; f Int -&gt; Int
forall (m :: * -&gt; *) a. Indexable m a =&gt; Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Interface.html#indexProject"><span class="hs-operator hs-var">`indexProject`</span></a></span><span> </span><span class="annot"><span class="annottext">f Int
forall (m :: * -&gt; *) a. (Indexable m a, Integral a) =&gt; m a
</span><a href="Math.Matrix.Interface.html#indexableIndices"><span class="hs-identifier hs-var">indexableIndices</span></a></span><span>
</span><span id="line-86"></span><span>                   </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Index f Int
</span><a href="#local-6989586621681274830"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Index f Int -&gt; f Int -&gt; Int
forall (m :: * -&gt; *) a. Indexable m a =&gt; Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Interface.html#indexProject"><span class="hs-operator hs-var">`indexProject`</span></a></span><span> </span><span class="annot"><span class="annottext">f Int
forall (m :: * -&gt; *) a. (Indexable m a, Integral a) =&gt; m a
</span><a href="Math.Matrix.Interface.html#indexableIndices"><span class="hs-identifier hs-var">indexableIndices</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span> </span><span id="local-6989586621681274657"><span id="local-6989586621681274658"><span class="annot"><a href="Math.Matrix.Indexable.html#sumIndices"><span class="hs-identifier hs-type">sumIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621681274657"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#Indexable"><span class="hs-identifier hs-type">Indexable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274657"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274658"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681274658"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681274657"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Math.Matrix.Interface.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681274657"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681274658"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681274658"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-89"></span><span> </span><span id="sumIndices"><span class="annot"><span class="annottext">sumIndices :: forall (f :: * -&gt; *) b.
(Foldable f, Indexable f b, Num b) =&gt;
(:*:) f f b -&gt; b
</span><a href="Math.Matrix.Indexable.html#sumIndices"><span class="hs-identifier hs-var hs-var">sumIndices</span></a></span></span><span> </span><span id="local-6989586621681274845"><span class="annot"><span class="annottext">(:*:) f f b
</span><a href="#local-6989586621681274845"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; b
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="Math.Matrix.Interface.html#sumCoordinates"><span class="hs-identifier hs-var">sumCoordinates</span></a></span><span> </span><span class="annot"><span class="annottext">(f b -&gt; b) -&gt; f b -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Index f b -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
(Indexable f a, Num a) =&gt;
(Index f a -&gt; b) -&gt; f b
</span><a href="Math.Matrix.Indexable.html#with"><span class="hs-identifier hs-var">with</span></a></span><span> </span><span class="annot"><span class="annottext">((Index f b -&gt; b) -&gt; f b) -&gt; (Index f b -&gt; b) -&gt; f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681274847"><span class="annot"><span class="annottext">Index f b
</span><a href="#local-6989586621681274847"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>     </span><span class="annot"><span class="annottext">(:*:) f f b
</span><a href="#local-6989586621681274845"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(:*:) f f b -&gt; (f b -&gt; b, f b -&gt; b) -&gt; b
forall (f :: * -&gt; *) (g :: * -&gt; *) a c b.
(Functor f, Functor g) =&gt;
(:*:) g f a -&gt; (g c -&gt; b, f a -&gt; c) -&gt; b
</span><a href="Math.Matrix.Interface.html#%3C%21%3E"><span class="hs-operator hs-var">&lt;!&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index f b -&gt; f b -&gt; b
forall (m :: * -&gt; *) a. Indexable m a =&gt; Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Interface.html#indexProject"><span class="hs-identifier hs-var">indexProject</span></a></span><span> </span><span class="annot"><span class="annottext">Index f b
</span><a href="#local-6989586621681274847"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Index f b -&gt; f b -&gt; b
forall (m :: * -&gt; *) a. Indexable m a =&gt; Index m a -&gt; m a -&gt; a
</span><a href="Math.Matrix.Interface.html#indexProject"><span class="hs-identifier hs-var">indexProject</span></a></span><span> </span><span class="annot"><span class="annottext">Index f b
</span><a href="#local-6989586621681274847"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span></pre></body></html>